/*! For license information please see index.js.LICENSE.txt */
(()=>{"use strict";var t={d:(r,i)=>{for(var o in i)t.o(i,o)&&!t.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:i[o]})},o:(t,r)=>Object.prototype.hasOwnProperty.call(t,r)};t.d({},{D:()=>C});function _slicedToArray(t,r){return function _arrayWithHoles(t){if(Array.isArray(t))return t}(t)||function _iterableToArrayLimit(t,r){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var o,a,l,c,u=[],d=!0,h=!1;try{if(l=(i=i.call(t)).next,0===r){if(Object(i)!==i)return;d=!1}else for(;!(d=(o=l.call(i)).done)&&(u.push(o.value),u.length!==r);d=!0);}catch(t){h=!0,a=t}finally{try{if(!d&&null!=i.return&&(c=i.return(),Object(c)!==c))return}finally{if(h)throw a}}return u}}(t,r)||function _unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return _arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return _arrayLikeToArray(t,r)}(t,r)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var r={},i=!1;function registerSettings(){!function registerSettingsArray(t){for(var o=function _loop(){var t=_slicedToArray(l[a],2),o=t[0],c=t[1];if(c.name||(c.name="".concat(C,".settings.").concat(o,".name")),c.hint||(c.hint="".concat(C,".settings.").concat(o,".hint")),void 0===c.useCache&&(c.useCache=i),c.useCache){var u=c.onChange;c.onChange&&(c.onChange=function(t){r[o]=t,u&&u(t)})}game.settings.register(C,o,c),c.useCache&&(r[o]=settings_getSetting(o))},a=0,l=Object.entries(t);a<l.length;a++)o()}({devMode:{name:"Developer Mode",hint:"Enable developer mode",scope:"world",config:!0,default:!1,type:Boolean,requiresReload:!0},votes:{scope:"world",config:!1,default:{},type:Object}})}function settings_getSetting(t){var i;return null!==(i=r[t])&&void 0!==i?i:game.settings.get(C,t)}function callingCard_typeof(t){return callingCard_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},callingCard_typeof(t)}function callingCard_regeneratorRuntime(){callingCard_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},r=Object.prototype,i=r.hasOwnProperty,o=Object.defineProperty||function(t,r,i){t[r]=i.value},a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(t,r,i){return Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,i){return t[r]=i}}function wrap(t,r,i,a){var l=r&&r.prototype instanceof Generator?r:Generator,c=Object.create(l.prototype),u=new Context(a||[]);return o(c,"_invoke",{value:makeInvokeMethod(t,i,u)}),c}function tryCatch(t,r,i){try{return{type:"normal",arg:t.call(r,i)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var d={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var h={};define(h,l,(function(){return this}));var p=Object.getPrototypeOf,v=p&&p(p(values([])));v&&v!==r&&i.call(v,l)&&(h=v);var y=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(h);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(o,a,l,c){var u=tryCatch(t[o],t,a);if("throw"!==u.type){var d=u.arg,h=d.value;return h&&"object"==callingCard_typeof(h)&&i.call(h,"__await")?r.resolve(h.__await).then((function(t){invoke("next",t,l,c)}),(function(t){invoke("throw",t,l,c)})):r.resolve(h).then((function(t){d.value=t,l(d)}),(function(t){return invoke("throw",t,l,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function value(t,i){function callInvokeWithMethodAndArg(){return new r((function(r,o){invoke(t,i,r,o)}))}return a=a?a.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,i){var o="suspendedStart";return function(a,l){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw l;return doneResult()}for(i.method=a,i.arg=l;;){var c=i.delegate;if(c){var u=maybeInvokeDelegate(c,i);if(u){if(u===d)continue;return u}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===o)throw o="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);o="executing";var h=tryCatch(t,r,i);if("normal"===h.type){if(o=i.done?"completed":"suspendedYield",h.arg===d)continue;return{value:h.arg,done:i.done}}"throw"===h.type&&(o="completed",i.method="throw",i.arg=h.arg)}}}function maybeInvokeDelegate(t,r){var i=r.method,o=t.iterator[i];if(void 0===o)return r.delegate=null,"throw"===i&&t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),d;var a=tryCatch(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,d;var l=a.arg;return l?l.done?(r[t.resultName]=l.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,d):l:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[l];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function next(){for(;++o<t.length;)if(i.call(t,o))return next.value=t[o],next.done=!1,next;return next.value=void 0,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(y,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,i,o,a,l){void 0===l&&(l=Promise);var c=new AsyncIterator(wrap(r,i,o,a),l);return t.isGeneratorFunction(i)?c:c.next().then((function(t){return t.done?t.value:c.next()}))},defineIteratorMethods(y),define(y,u,"Generator"),define(y,l,(function(){return this})),define(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),i=[];for(var o in r)i.push(o);return i.reverse(),function next(){for(;i.length;){var t=i.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(i,o){return l.type="throw",l.arg=t,r.next=i,o&&(r.method="next",r.arg=void 0),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],l=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&i.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var l=a;break}}l&&("break"===t||"continue"===t)&&l.tryLoc<=r&&r<=l.finallyLoc&&(l=null);var c=l?l.completion:{};return c.type=t,c.arg=r,l?(this.method="next",this.next=l.finallyLoc,d):this.complete(c)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),resetTryEntry(i),d}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc===t){var o=i.completion;if("throw"===o.type){var a=o.arg;resetTryEntry(i)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,i){return this.delegate={iterator:values(t),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=void 0),d}},t}function callingCard_asyncGeneratorStep(t,r,i,o,a,l,c){try{var u=t[l](c),d=u.value}catch(t){return void i(t)}u.done?r(d):Promise.resolve(d).then(o,a)}function callingCard_asyncToGenerator(t){return function(){var r=this,i=arguments;return new Promise((function(o,a){var l=t.apply(r,i);function _next(t){callingCard_asyncGeneratorStep(l,o,a,_next,_throw,"next",t)}function _throw(t){callingCard_asyncGeneratorStep(l,o,a,_next,_throw,"throw",t)}_next(void 0)}))}}function callingCard_defineProperties(t,r){for(var i=0;i<r.length;i++){var o=r[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(a=o.key,l=void 0,l=function callingCard_toPrimitive(t,r){if("object"!==callingCard_typeof(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var o=i.call(t,r||"default");if("object"!==callingCard_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(a,"string"),"symbol"===callingCard_typeof(l)?l:String(l)),o)}var a,l}var o=function(){function CallingCard(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{large:!0,render:!0};!function callingCard_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,CallingCard),this.text=t,this.options=r,this.element=document.createElement("div"),this.element.classList.add("sqs-calling-card-container"),this.card=document.createElement("div"),this.card.classList.add("sqs-calling-card"),this.options.large&&this.card.classList.add("large"),this.element.appendChild(this.card),r.render&&this.render()}var t,r;return function callingCard_createClass(t,r,i){return r&&callingCard_defineProperties(t.prototype,r),i&&callingCard_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}(CallingCard,[{key:"render",value:(r=callingCard_asyncToGenerator(callingCard_regeneratorRuntime().mark((function _callee(){var t=this;return callingCard_regeneratorRuntime().wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return document.body.appendChild(this.element),this.element.animate([{opacity:0},{opacity:1}],{duration:300,easing:"ease-in-out"}),r.next=4,this.getCardHtml();case 4:this.activate3DCard(),this.element.addEventListener("contextmenu",(function(r){r.preventDefault(),t.element.animate([{opacity:1},{opacity:0}],{duration:300,easing:"ease-in-out"}).onfinish=function(){t.element.remove()}}));case 6:case"end":return r.stop()}}),_callee,this)}))),function render(){return r.apply(this,arguments)})},{key:"getCardHtml",value:(t=callingCard_asyncToGenerator(callingCard_regeneratorRuntime().mark((function _callee2(){var t,r;return callingCard_regeneratorRuntime().wrap((function _callee2$(i){for(;;)switch(i.prev=i.next){case 0:t="modules/".concat(C,"/assets/sqs-card-logo.webp"),r='\n        <img src="'.concat(t,'" alt="Side Quest Society Logo" class="sqs-card-front">\n        <div class="sqs-card-back hidden" background-image="url(\'').concat(t,"')\">\n            ").concat(this.text,"\n        </div>\n        "),this.card.innerHTML=r;case 3:case"end":return i.stop()}}),_callee2,this)}))),function getCardHtml(){return t.apply(this,arguments)})},{key:"activate3DCard",value:function activate3DCard(){var t=this;this.card.addEventListener("mousemove",(function(r){if(!t.flipping){var i=t.card.getBoundingClientRect(),o=i.width,a=i.height,l=i.left,c=i.top,u=r.clientX-l,d=o/2,h=a/2,p=(r.clientY-c-h)/h*15,v=(d-u)/d*15;t.card.style.transform="perspective(1000px) rotateX(".concat(p,"deg) rotateY(").concat(v,"deg)")}})),this.card.addEventListener("mouseleave",(function(){t.flipping||(t.card.style.transition="transform 0.3s ease-out",t.card.style.transform="perspective(1000px) rotateX(0deg) rotateY(0deg)")})),this.card.addEventListener("mouseenter",(function(){t.flipping||(t.card.style.transition="none")})),this.card.addEventListener("click",(function(){return t.flipCard()}))}},{key:"flipCard",value:function flipCard(){var t=this;this.card.style.transition="transform 0.3s ease",this.card.style.transform="perspective(1000px) rotateY(90deg)",this.flipping=!0,setTimeout((function(){var r=t.card.children;r.length>=2&&(r[0].classList.toggle("hidden"),r[1].classList.toggle("hidden")),t.card.style.transform="perspective(1000px) rotateY(0deg)",t.flipping=!1}),300)}}]),CallingCard}();function formBuilder_typeof(t){return formBuilder_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},formBuilder_typeof(t)}function _toConsumableArray(t){return function _arrayWithoutHoles(t){if(Array.isArray(t))return formBuilder_arrayLikeToArray(t)}(t)||function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||formBuilder_unsupportedIterableToArray(t)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _createForOfIteratorHelper(t,r){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=formBuilder_unsupportedIterableToArray(t))||r&&t&&"number"==typeof t.length){i&&(t=i);var o=0,a=function F(){};return{s:a,n:function n(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,c=!0,u=!1;return{s:function s(){i=i.call(t)},n:function n(){var t=i.next();return c=t.done,t},e:function e(t){u=!0,l=t},f:function f(){try{c||null==i.return||i.return()}finally{if(u)throw l}}}}function formBuilder_unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return formBuilder_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?formBuilder_arrayLikeToArray(t,r):void 0}}function formBuilder_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function formBuilder_get(){return formBuilder_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function _get(t,r,i){var o=function formBuilder_superPropBase(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&null!==(t=formBuilder_getPrototypeOf(t)););return t}(t,r);if(o){var a=Object.getOwnPropertyDescriptor(o,r);return a.get?a.get.call(arguments.length<3?t:i):a.value}},formBuilder_get.apply(this,arguments)}function formBuilder_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&formBuilder_setPrototypeOf(t,r)}function formBuilder_setPrototypeOf(t,r){return formBuilder_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(t,r){return t.__proto__=r,t},formBuilder_setPrototypeOf(t,r)}function formBuilder_createSuper(t){var r=function formBuilder_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var i,o=formBuilder_getPrototypeOf(t);if(r){var a=formBuilder_getPrototypeOf(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return function formBuilder_possibleConstructorReturn(t,r){if(r&&("object"===formBuilder_typeof(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return formBuilder_assertThisInitialized(t)}(this,i)}}function formBuilder_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function formBuilder_getPrototypeOf(t){return formBuilder_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)},formBuilder_getPrototypeOf(t)}function formBuilder_ownKeys(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),i.push.apply(i,o)}return i}function formBuilder_objectSpread(t){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?formBuilder_ownKeys(Object(i),!0).forEach((function(r){formBuilder_defineProperty(t,r,i[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):formBuilder_ownKeys(Object(i)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r))}))}return t}function formBuilder_defineProperty(t,r,i){return(r=formBuilder_toPropertyKey(r))in t?Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[r]=i,t}function formBuilder_regeneratorRuntime(){formBuilder_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},r=Object.prototype,i=r.hasOwnProperty,o=Object.defineProperty||function(t,r,i){t[r]=i.value},a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(t,r,i){return Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,i){return t[r]=i}}function wrap(t,r,i,a){var l=r&&r.prototype instanceof Generator?r:Generator,c=Object.create(l.prototype),u=new Context(a||[]);return o(c,"_invoke",{value:makeInvokeMethod(t,i,u)}),c}function tryCatch(t,r,i){try{return{type:"normal",arg:t.call(r,i)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var d={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var h={};define(h,l,(function(){return this}));var p=Object.getPrototypeOf,v=p&&p(p(values([])));v&&v!==r&&i.call(v,l)&&(h=v);var y=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(h);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(o,a,l,c){var u=tryCatch(t[o],t,a);if("throw"!==u.type){var d=u.arg,h=d.value;return h&&"object"==formBuilder_typeof(h)&&i.call(h,"__await")?r.resolve(h.__await).then((function(t){invoke("next",t,l,c)}),(function(t){invoke("throw",t,l,c)})):r.resolve(h).then((function(t){d.value=t,l(d)}),(function(t){return invoke("throw",t,l,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function value(t,i){function callInvokeWithMethodAndArg(){return new r((function(r,o){invoke(t,i,r,o)}))}return a=a?a.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,i){var o="suspendedStart";return function(a,l){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw l;return doneResult()}for(i.method=a,i.arg=l;;){var c=i.delegate;if(c){var u=maybeInvokeDelegate(c,i);if(u){if(u===d)continue;return u}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===o)throw o="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);o="executing";var h=tryCatch(t,r,i);if("normal"===h.type){if(o=i.done?"completed":"suspendedYield",h.arg===d)continue;return{value:h.arg,done:i.done}}"throw"===h.type&&(o="completed",i.method="throw",i.arg=h.arg)}}}function maybeInvokeDelegate(t,r){var i=r.method,o=t.iterator[i];if(void 0===o)return r.delegate=null,"throw"===i&&t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),d;var a=tryCatch(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,d;var l=a.arg;return l?l.done?(r[t.resultName]=l.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,d):l:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[l];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function next(){for(;++o<t.length;)if(i.call(t,o))return next.value=t[o],next.done=!1,next;return next.value=void 0,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(y,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,i,o,a,l){void 0===l&&(l=Promise);var c=new AsyncIterator(wrap(r,i,o,a),l);return t.isGeneratorFunction(i)?c:c.next().then((function(t){return t.done?t.value:c.next()}))},defineIteratorMethods(y),define(y,u,"Generator"),define(y,l,(function(){return this})),define(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),i=[];for(var o in r)i.push(o);return i.reverse(),function next(){for(;i.length;){var t=i.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(i,o){return l.type="throw",l.arg=t,r.next=i,o&&(r.method="next",r.arg=void 0),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],l=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&i.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var l=a;break}}l&&("break"===t||"continue"===t)&&l.tryLoc<=r&&r<=l.finallyLoc&&(l=null);var c=l?l.completion:{};return c.type=t,c.arg=r,l?(this.method="next",this.next=l.finallyLoc,d):this.complete(c)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),resetTryEntry(i),d}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc===t){var o=i.completion;if("throw"===o.type){var a=o.arg;resetTryEntry(i)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,i){return this.delegate={iterator:values(t),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=void 0),d}},t}function formBuilder_asyncGeneratorStep(t,r,i,o,a,l,c){try{var u=t[l](c),d=u.value}catch(t){return void i(t)}u.done?r(d):Promise.resolve(d).then(o,a)}function formBuilder_asyncToGenerator(t){return function(){var r=this,i=arguments;return new Promise((function(o,a){var l=t.apply(r,i);function _next(t){formBuilder_asyncGeneratorStep(l,o,a,_next,_throw,"next",t)}function _throw(t){formBuilder_asyncGeneratorStep(l,o,a,_next,_throw,"throw",t)}_next(void 0)}))}}function formBuilder_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function formBuilder_defineProperties(t,r){for(var i=0;i<r.length;i++){var o=r[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,formBuilder_toPropertyKey(o.key),o)}}function formBuilder_createClass(t,r,i){return r&&formBuilder_defineProperties(t.prototype,r),i&&formBuilder_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function formBuilder_toPropertyKey(t){var r=function formBuilder_toPrimitive(t,r){if("object"!==formBuilder_typeof(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var o=i.call(t,r||"default");if("object"!==formBuilder_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"===formBuilder_typeof(r)?r:String(r)}function formBuilder_classPrivateMethodInitSpec(t,r){formBuilder_checkPrivateRedeclaration(t,r),r.add(t)}function _classPrivateFieldInitSpec(t,r,i){formBuilder_checkPrivateRedeclaration(t,r),r.set(t,i)}function formBuilder_checkPrivateRedeclaration(t,r){if(r.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function formBuilder_classPrivateMethodGet(t,r,i){if(!r.has(t))throw new TypeError("attempted to get private field on non-instance");return i}function _classPrivateFieldSet(t,r,i){return function _classApplyDescriptorSet(t,r,i){if(r.set)r.set.call(t,i);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=i}}(t,_classExtractFieldDescriptor(t,r,"set"),i),i}function _classPrivateFieldGet(t,r){return function _classApplyDescriptorGet(t,r){if(r.get)return r.get.call(t);return r.value}(t,_classExtractFieldDescriptor(t,r,"get"))}function _classExtractFieldDescriptor(t,r,i){if(!r.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return r.get(t)}var a="6uy8g1tXqHlhlp65dhiL-genericFormHelper-"+C,l=new WeakMap,c=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap,p=new WeakMap,v=new WeakMap,y=new WeakMap,m=new WeakSet,g=function(){function FormBuilder(){formBuilder_classCallCheck(this,FormBuilder),formBuilder_classPrivateMethodInitSpec(this,m),_classPrivateFieldInitSpec(this,l,{writable:!0,value:[]}),_classPrivateFieldInitSpec(this,c,{writable:!0,value:[]}),_classPrivateFieldInitSpec(this,u,{writable:!0,value:[]}),_classPrivateFieldInitSpec(this,d,{writable:!0,value:{position:{width:560,height:"auto"},window:{}}}),_classPrivateFieldInitSpec(this,h,{writable:!0,value:null}),_classPrivateFieldInitSpec(this,p,{writable:!0,value:null}),_classPrivateFieldInitSpec(this,v,{writable:!0,value:null}),_classPrivateFieldInitSpec(this,y,{writable:!0,value:null}),this.submitButton()}var t,r;return formBuilder_createClass(FormBuilder,[{key:"app",get:function get(){return _classPrivateFieldGet(this,y)}},{key:"render",value:(r=formBuilder_asyncToGenerator(formBuilder_regeneratorRuntime().mark((function _callee(){var t;return formBuilder_regeneratorRuntime().wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return(t=this.form()).render(!0),r.abrupt("return",t.promise);case 3:case"end":return r.stop()}}),_callee,this)}))),function render(){return r.apply(this,arguments)})},{key:"form",value:function form(){if(_classPrivateFieldGet(this,y))return _classPrivateFieldGet(this,y);var t=new k({tabs:_classPrivateFieldGet(this,l),fields:_classPrivateFieldGet(this,c),buttons:_classPrivateFieldGet(this,u),options:_classPrivateFieldGet(this,d)});return _classPrivateFieldSet(this,y,t),t}},{key:"getHTML",value:function getHTML(){var t=this.form()._prepareContext();return k.registerPartial(),renderTemplate(a,t)}},{key:"getAsClass",value:function getAsClass(t){var r=formBuilder_objectSpread(formBuilder_objectSpread({},t),{},{tabs:_classPrivateFieldGet(this,l),fields:_classPrivateFieldGet(this,c),buttons:_classPrivateFieldGet(this,u),options:_classPrivateFieldGet(this,d)});return function(t){formBuilder_inherits(_class,t);var i=formBuilder_createSuper(_class);function _class(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return formBuilder_classCallCheck(this,_class),i.call(this,formBuilder_objectSpread(formBuilder_objectSpread({},r),t))}return formBuilder_createClass(_class)}(k)}},{key:"onRender",value:function onRender(t){return _classPrivateFieldGet(this,d).onRender=t,this}},{key:"registerAsMenu",value:function registerAsMenu(){var t,r,i,o,a,l,c,u,d,h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},p=h.moduleId,v=h.key,y=h.name,m=h.label,g=h.icon,_=h.hint,b=h.scope,w=h.restricted,P=h.defaultValue,x=h.onChange,k=h.requiresReload;null!==(t=p)&&void 0!==t||(p=C),null!==(r=b)&&void 0!==r||(b="world"),null!==(i=w)&&void 0!==i||(w=!0),null!==(o=P)&&void 0!==o||(P={}),null!==(a=v)&&void 0!==a||(v="settings"),null!==(l=g)&&void 0!==l||(g="fas fa-cogs"),null!==(c=m)&&void 0!==c||(m="Configure"),null!==(u=y)&&void 0!==u||(y="Configuration Menu"),null!==(d=_)&&void 0!==d||(_="Configure the module settings");var S={settingsMenu:{requiresReload:k,onChange:x,moduleId:p,key:v}},G=this.getAsClass(S);return game.settings.registerMenu(p,v+"-menu",{name:y,label:m,hint:_,icon:g,scope:b,restricted:w,type:G}),game.settings.register(p,v,{scope:b,config:!1,default:P,type:Object,onChange:x,requiresReload:k}),{getSetting:function getSetting(){return game.settings.get(p,v)},setSetting:function setSetting(t){return game.settings.set(p,v,t)}}}},{key:"insertHTML",value:(t=formBuilder_asyncToGenerator(formBuilder_regeneratorRuntime().mark((function _callee2(t,r){var i,o,a,l,c,u=arguments;return formBuilder_regeneratorRuntime().wrap((function _callee2$(d){for(;;)switch(d.prev=d.next){case 0:return i=u.length>2&&void 0!==u[2]?u[2]:"afterend",d.next=3,this.getHTML();case 3:if(o=d.sent,(a=document.createElement("div")).innerHTML=o,l=a.children[0],c=r?t.querySelector(r):t){d.next=10;break}throw new Error("Element ".concat(r," not found"));case 10:return c.insertAdjacentElement(i,l),d.abrupt("return",l);case 12:case"end":return d.stop()}}),_callee2,this)}))),function insertHTML(r,i){return t.apply(this,arguments)})},{key:"title",value:function title(t){return _classPrivateFieldGet(this,d).window.title=t,this}},{key:"resizable",value:function resizable(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return _classPrivateFieldGet(this,d).window.resizable=t,this}},{key:"info",value:function info(t){return _classPrivateFieldGet(this,d).info=t,this}},{key:"object",value:function object(t){return _classPrivateFieldSet(this,v,t),this}},{key:"size",value:function size(t){var r=t.width,i=t.height;return _classPrivateFieldGet(this,d).position={width:null!=r?r:560,height:null!=i?i:"auto"},this}},{key:"submitButton",value:function submitButton(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.enabled,i=void 0===r||r,o=t.label,a=void 0===o?"Confirm":o,l=t.icon,submitButton={type:"submit",action:"submit",icon:void 0===l?"fa-solid fa-check":l,label:a};return i?_classPrivateFieldGet(this,u).push(submitButton):_classPrivateFieldSet(this,u,_classPrivateFieldGet(this,u).filter((function(t){return"submit"!==t.action}))),this}},{key:"tab",value:function tab(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=r.id,o=r.group,a=r.icon,c=r.label,u=r.active,d=void 0!==u&&u;if(null!==(t=o)&&void 0!==t||(o="sheet"),!i&&_classPrivateFieldGet(this,h))return _classPrivateFieldSet(this,h,null),this;if(!i)throw new Error("You must provide an id for the tab");var tab={id:i,group:o,icon:a,label:c,active:d,fields:[]};return _classPrivateFieldGet(this,l).push(tab),_classPrivateFieldSet(this,h,tab),this}},{key:"fieldset",value:function fieldset(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).legend;if(!t&&_classPrivateFieldGet(this,p))return _classPrivateFieldSet(this,p,null),this;if(!t)throw new Error("You must provide a legend for the fieldset");var fieldset={legend:t,fieldset:!0,fields:[]};return formBuilder_classPrivateMethodGet(this,m,_addField2).call(this,fieldset),_classPrivateFieldSet(this,p,fieldset),this}},{key:"html",value:function html(t){var r={html:t};return formBuilder_classPrivateMethodGet(this,m,_addField2).call(this,r),this}},{key:"text",value:function text(t){var r=t.name,i=t.label,o=t.hint,a=t.value,l={field:new foundry.data.fields.StringField,name:r,label:i,hint:o,value:a};return formBuilder_classPrivateMethodGet(this,m,_addField2).call(this,l),this}},{key:"number",value:function number(t){var r=t.name,i=t.label,o=t.hint,a=t.value,l=t.min,c=t.max,u=t.step,d={field:new foundry.data.fields.NumberField,name:r,label:i,hint:o,value:a,min:l,max:c,step:u};return formBuilder_classPrivateMethodGet(this,m,_addField2).call(this,d),this}},{key:"checkbox",value:function checkbox(t){var r=t.name,i=t.label,o=t.hint,a=t.value,l={field:new foundry.data.fields.BooleanField,name:r,label:i,hint:o,value:a};return formBuilder_classPrivateMethodGet(this,m,_addField2).call(this,l),this}},{key:"color",value:function color(t){var r=t.name,i=t.label,o=t.hint,a=t.value,l={field:new foundry.data.fields.ColorField,name:r,label:i,hint:o,value:a};return formBuilder_classPrivateMethodGet(this,m,_addField2).call(this,l),this}},{key:"file",value:function file(t){var r,i=t.name,o=t.type,a=t.label,l=t.hint,c=t.value;null!==(r=o)&&void 0!==r||(o="imagevideo");var u=_[o],d=new foundry.data.fields.FilePathField({categories:u});d.categories=[o];var h={field:d,name:i,label:a,hint:l,type:o,value:c};return formBuilder_classPrivateMethodGet(this,m,_addField2).call(this,h),this}},{key:"select",value:function select(t){var r,i=t.name,o=t.label,a=t.hint,l=t.value,c=t.options,u={field:inferSelectDataType(c)===Number?new foundry.data.fields.NumberField({choices:c,required:!0}):new foundry.data.fields.StringField({choices:c,required:!0,blank:!1}),name:i,label:o,hint:a,value:null!=l?l:null===(r=c[0])||void 0===r?void 0:r.key,options:c};return formBuilder_classPrivateMethodGet(this,m,_addField2).call(this,u),this}},{key:"multiSelect",value:function multiSelect(t){var r=t.name,i=t.label,o=t.hint,a=t.value,l=t.options,c=inferSelectDataType(l)===Number?new foundry.data.fields.NumberField({choices:l,nullable:!1}):new foundry.data.fields.StringField({choices:l,nullable:!1}),u={field:new foundry.data.fields.SetField(c),name:r,label:i,hint:o,value:a,options:l};return formBuilder_classPrivateMethodGet(this,m,_addField2).call(this,u),this}},{key:"editor",value:function editor(t){var r=t.name,i=t.label,o=t.hint,a=t.value,l={field:new foundry.data.fields.HTMLField,name:r,label:i,hint:o,value:a};return formBuilder_classPrivateMethodGet(this,m,_addField2).call(this,l),this}},{key:"textArea",value:function textArea(t){var r=t.name,i=t.label,o=t.hint,a=t.value,l={field:new foundry.data.fields.JSONField,name:r,label:i,hint:o,value:a,stacked:!0};return formBuilder_classPrivateMethodGet(this,m,_addField2).call(this,l),this}},{key:"script",value:function script(t){var r=t.name,i=t.label,o=t.hint,a=t.value,l={field:new foundry.data.fields.JavaScriptField,name:r,label:i,hint:o,value:a};return formBuilder_classPrivateMethodGet(this,m,_addField2).call(this,l),this}},{key:"uuid",value:function uuid(t){var r,i=t.name,o=t.label,a=t.hint,l=t.value,c=t.type,u=t.multiple,d={field:new foundry.data.fields.DocumentUUIDField({},{type:c}),name:i,label:o,hint:a,value:l,type:c,multiple:u};return r=u?{field:new foundry.data.fields.SetField(d.field),name:i,label:o,hint:a,value:l,multiple:u}:d,formBuilder_classPrivateMethodGet(this,m,_addField2).call(this,r),this}},{key:"button",value:function button(t){var r,i=t.label,o=t.action,a=t.icon,l=t.callback;null!==(r=o)&&void 0!==r||(o=foundry.utils.randomID());var button={action:o,type:"button",icon:a,label:i,callback:l};return _classPrivateFieldGet(this,u).push(button),this}}]),FormBuilder}();function _addField2(t){if(_classPrivateFieldGet(this,v)&&t.name){var r=foundry.utils.getProperty(_classPrivateFieldGet(this,v),t.name);void 0!==r&&(t.value=r)}return _classPrivateFieldGet(this,p)?_classPrivateFieldGet(this,p).fields.push(t):_classPrivateFieldGet(this,h)?_classPrivateFieldGet(this,h).fields.push(t):_classPrivateFieldGet(this,c).push(t)}var _={imagevideo:["IMAGE","VIDEO"],image:["IMAGE"],video:["VIDEO"],audio:["AUDIO"],font:["FONT"],graphics:["GRAPHICS"]};function inferSelectDataType(t){var r=Array.isArray(t)?t.map((function(t){return t.key})):Object.keys(t);try{if(r.every((function(t){return"number"==typeof JSON.parse(t)})))return Number}catch(t){return String}return String}var b=new WeakMap,w=new WeakMap,P=new WeakMap,x=new WeakSet,k=function(){formBuilder_inherits(FormHelper,foundry.applications.api.HandlebarsApplicationMixin(foundry.applications.api.ApplicationV2));var t=formBuilder_createSuper(FormHelper);function FormHelper(r){var i;formBuilder_classCallCheck(this,FormHelper);var o={};return r.buttons.forEach((function(t){return o[t.action]=t.callback})),formBuilder_classPrivateMethodInitSpec(formBuilder_assertThisInitialized(i=t.call(this,formBuilder_objectSpread({actions:o},r.options))),x),_classPrivateFieldInitSpec(formBuilder_assertThisInitialized(i),b,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(formBuilder_assertThisInitialized(i),w,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(formBuilder_assertThisInitialized(i),P,{writable:!0,value:void 0}),FormHelper.registerPartial(),i.menu=r.settingsMenu,i.resolve,i.reject,i.promise=new Promise((function(t,r){i.resolve=t,i.reject=r})),i.onRenderFunction=r.options.onRender,_classPrivateFieldSet(formBuilder_assertThisInitialized(i),P,r.options.info),i.processFormStructure(r),i}return formBuilder_createClass(FormHelper,[{key:"processFormStructure",value:function processFormStructure(t){var r,i,o,a=this.menu?game.settings.get(this.menu.moduleId,this.menu.key):{},l=!!this.menu;if(null!==(r=t.tabs)&&void 0!==r&&r.length){this.__tabs={},t.tabs.find((function(t){return t.active}))||(t.tabs[0].active=!0);var c,u=_createForOfIteratorHelper(t.tabs);try{for(u.s();!(c=u.n()).done;){var d,h,p=c.value;if(this.__tabs[p.id]={id:p.id,group:p.group,icon:p.icon,label:p.label,active:null!==(d=p.active)&&void 0!==d&&d,fields:null!==(h=p.fields)&&void 0!==h?h:[]},l){var v,y,m=_createForOfIteratorHelper(null!==(v=p.fields)&&void 0!==v?v:[]);try{for(m.s();!(y=m.n()).done;){var g=y.value,_=foundry.utils.getProperty(a,g.name);void 0!==_&&(g.value=_)}}catch(t){m.e(t)}finally{m.f()}}}}catch(t){u.e(t)}finally{u.f()}}if(l){var P,x,k=_createForOfIteratorHelper(null!==(P=t.fields)&&void 0!==P?P:[]);try{for(k.s();!(x=k.n()).done;){var S=x.value,G=foundry.utils.getProperty(a,S.name);void 0!==G&&(S.value=G)}}catch(t){k.e(t)}finally{k.f()}}_classPrivateFieldSet(this,b,null!==(i=t.fields)&&void 0!==i?i:[]),_classPrivateFieldSet(this,w,null!==(o=t.buttons)&&void 0!==o?o:[])}},{key:"_onClose",value:function _onClose(t){formBuilder_get(formBuilder_getPrototypeOf(FormHelper.prototype),"_onClose",this).call(this,t),this.promise.resolved||this.resolve(!1)}},{key:"_prepareContext",value:function _prepareContext(t){return{tabs:formBuilder_classPrivateMethodGet(this,x,_getTabs2).call(this),fields:_classPrivateFieldGet(this,b),info:_classPrivateFieldGet(this,P),buttons:[].concat(_toConsumableArray(_classPrivateFieldGet(this,w).filter((function(t){return"submit"!==t.type}))),_toConsumableArray(_classPrivateFieldGet(this,w).filter((function(t){return"submit"===t.type}))))}}},{key:"_onRender",value:function _onRender(t,r){formBuilder_get(formBuilder_getPrototypeOf(FormHelper.prototype),"_onRender",this).call(this,t,r),this.__tabs||this.element.querySelector("nav").classList.add("hidden"),this.onRenderFunction&&this.onRenderFunction.bind(this)(t,r)}},{key:"changeTab",value:function changeTab(){for(var t,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];(t=formBuilder_get(formBuilder_getPrototypeOf(FormHelper.prototype),"changeTab",this)).call.apply(t,[this].concat(i))}},{key:"_onChangeForm",value:function _onChangeForm(t,r){formBuilder_get(formBuilder_getPrototypeOf(FormHelper.prototype),"_onChangeForm",this).call(this,t,r);new FormDataExtended(this.element)}},{key:"getFormData",value:function getFormData(){var t=new FormDataExtended(this.element);return foundry.utils.expandObject(t.object)}}],[{key:"registerPartial",value:function registerPartial(){if(!Handlebars.partials[a]){var t=Handlebars.compile(G);Handlebars.registerPartial(a,t)}}}]),FormHelper}();function _getTabs2(){for(var t,r=null!==(t=this.__tabs)&&void 0!==t?t:{},i=0,o=Object.values(r);i<o.length;i++){var a=o[i];if(a.cssClass=a.active?"active":"",a.active)break}return r}function _onSubmit3(){return(_onSubmit3=formBuilder_asyncToGenerator(formBuilder_regeneratorRuntime().mark((function _callee3(t,r,i){var o;return formBuilder_regeneratorRuntime().wrap((function _callee3$(t){for(;;)switch(t.prev=t.next){case 0:if(o=foundry.utils.expandObject(i.object),this.resolve(o),!this.menu){t.next=6;break}return this.menu.requiresReload&&SettingsConfig.reloadConfirm(),this.menu.onChange&&this.menu.onChange(o),t.abrupt("return",game.settings.set(this.menu.moduleId,this.menu.key,o));case 6:case"end":return t.stop()}}),_callee3,this)})))).apply(this,arguments)}formBuilder_defineProperty(k,"DEFAULT_OPTIONS",{classes:["form-helper"],tag:"form",window:{contentClasses:["standard-form"]},position:{width:560,height:"auto"},form:{handler:function _classStaticPrivateMethodGet(t,r,i){return function _classCheckPrivateStaticAccess(t,r){if(t!==r)throw new TypeError("Private static access of wrong provenance")}(t,r),i}(k,k,(function _onSubmit(t,r,i){return _onSubmit3.apply(this,arguments)})),closeOnSubmit:!0},actions:{}}),formBuilder_defineProperty(k,"PARTS",{tabs:{template:"templates/generic/tab-navigation.hbs"},genericForm:{template:a,classes:["standard-form","scrollable"]},footer:{template:"templates/generic/form-footer.hbs"}});var S="\n    {{#if field.fieldset}}\n    <fieldset>\n        <legend>{{localize field.legend}}</legend>\n        {{#each field.fields as |f|}}\n        {{#if f.html}}{{{f.html}}}{{else}}\n        {{formField f.field stacked=f.stacked type=f.type label=f.label hint=f.hint name=f.name value=f.value min=f.min max=f.max step=f.step localize=true}}\n        {{/if}}\n        {{/each}}\n    </fieldset>\n    {{else}}\n    {{#if field.html}}{{{field.html}}}{{else}}\n    {{formField field.field stacked=field.stacked multiple=field.multiple type=field.type label=field.label hint=field.hint name=field.name value=field.value min=field.min max=field.max step=field.step localize=true}}\n    {{/if}}\n    {{/if}}\n        ",G='<div>\n    {{#if info}}{{{info}}}{{/if}}\n    {{#each tabs as |tab|}}\n\n    <section class="tab standard-form scrollable {{tab.cssClass}}" data-tab="{{tab.id}}" data-group="{{tab.group}}">\n        {{#each tab.fields as |field|}}\n        '.concat(S,"\n        {{/each}}\n    </section>\n\n    {{/each}}\n\n    {{#each fields as |field|}}\n    ").concat(S,"\n    {{/each}}\n</div>");function config_typeof(t){return config_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},config_typeof(t)}function config_regeneratorRuntime(){config_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},r=Object.prototype,i=r.hasOwnProperty,o=Object.defineProperty||function(t,r,i){t[r]=i.value},a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(t,r,i){return Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,i){return t[r]=i}}function wrap(t,r,i,a){var l=r&&r.prototype instanceof Generator?r:Generator,c=Object.create(l.prototype),u=new Context(a||[]);return o(c,"_invoke",{value:makeInvokeMethod(t,i,u)}),c}function tryCatch(t,r,i){try{return{type:"normal",arg:t.call(r,i)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var d={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var h={};define(h,l,(function(){return this}));var p=Object.getPrototypeOf,v=p&&p(p(values([])));v&&v!==r&&i.call(v,l)&&(h=v);var y=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(h);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(o,a,l,c){var u=tryCatch(t[o],t,a);if("throw"!==u.type){var d=u.arg,h=d.value;return h&&"object"==config_typeof(h)&&i.call(h,"__await")?r.resolve(h.__await).then((function(t){invoke("next",t,l,c)}),(function(t){invoke("throw",t,l,c)})):r.resolve(h).then((function(t){d.value=t,l(d)}),(function(t){return invoke("throw",t,l,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function value(t,i){function callInvokeWithMethodAndArg(){return new r((function(r,o){invoke(t,i,r,o)}))}return a=a?a.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,i){var o="suspendedStart";return function(a,l){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===a)throw l;return doneResult()}for(i.method=a,i.arg=l;;){var c=i.delegate;if(c){var u=maybeInvokeDelegate(c,i);if(u){if(u===d)continue;return u}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===o)throw o="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);o="executing";var h=tryCatch(t,r,i);if("normal"===h.type){if(o=i.done?"completed":"suspendedYield",h.arg===d)continue;return{value:h.arg,done:i.done}}"throw"===h.type&&(o="completed",i.method="throw",i.arg=h.arg)}}}function maybeInvokeDelegate(t,r){var i=r.method,o=t.iterator[i];if(void 0===o)return r.delegate=null,"throw"===i&&t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),d;var a=tryCatch(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,d;var l=a.arg;return l?l.done?(r[t.resultName]=l.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,d):l:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[l];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function next(){for(;++o<t.length;)if(i.call(t,o))return next.value=t[o],next.done=!1,next;return next.value=void 0,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(y,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,i,o,a,l){void 0===l&&(l=Promise);var c=new AsyncIterator(wrap(r,i,o,a),l);return t.isGeneratorFunction(i)?c:c.next().then((function(t){return t.done?t.value:c.next()}))},defineIteratorMethods(y),define(y,u,"Generator"),define(y,l,(function(){return this})),define(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),i=[];for(var o in r)i.push(o);return i.reverse(),function next(){for(;i.length;){var t=i.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(i,o){return l.type="throw",l.arg=t,r.next=i,o&&(r.method="next",r.arg=void 0),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],l=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o];if(a.tryLoc<=this.prev&&i.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var l=a;break}}l&&("break"===t||"continue"===t)&&l.tryLoc<=r&&r<=l.finallyLoc&&(l=null);var c=l?l.completion:{};return c.type=t,c.arg=r,l?(this.method="next",this.next=l.finallyLoc,d):this.complete(c)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),resetTryEntry(i),d}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc===t){var o=i.completion;if("throw"===o.type){var a=o.arg;resetTryEntry(i)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,i){return this.delegate={iterator:values(t),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=void 0),d}},t}function config_asyncGeneratorStep(t,r,i,o,a,l,c){try{var u=t[l](c),d=u.value}catch(t){return void i(t)}u.done?r(d):Promise.resolve(d).then(o,a)}function initConfig(){settings_getSetting("devMode")&&Hooks.on("getCompendiumEntryContext",(function(t,r){t.collection.collection.includes("side-quest-society")&&r.push({name:"Edit SQS Metadata",icon:'<i class="fas fa-scroll"></i>',condition:!0,callback:function callback(r){return function editMetadata(t,r){return _editMetadata.apply(this,arguments)}(t.collection,r[0].dataset.documentId)}})}))}function _editMetadata(){return _editMetadata=function config_asyncToGenerator(t){return function(){var r=this,i=arguments;return new Promise((function(o,a){var l=t.apply(r,i);function _next(t){config_asyncGeneratorStep(l,o,a,_next,_throw,"next",t)}function _throw(t){config_asyncGeneratorStep(l,o,a,_next,_throw,"throw",t)}_next(void 0)}))}}(config_regeneratorRuntime().mark((function _callee(t,r){var i,o,a,l;return config_regeneratorRuntime().wrap((function _callee$(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,t.getDocument(r);case 2:return a=c.sent,c.next=5,(new g).object(null!==(i=null===(o=a.flags[C])||void 0===o?void 0:o.metadata)&&void 0!==i?i:{}).title("Edit Side Quest Society Metadata:"+a.name).text({name:"id",label:"ID",value:a.name.slugify({strict:!0})}).number({name:"level.min",label:"Level Range MIN",value:1}).number({name:"level.max",label:"Level Range MAX",value:20}).text({name:"endingOne",label:"Ending 1",value:"The necromancer is defeated."}).text({name:"endingTwo",label:"Ending 2",value:"The necromancer escaped."}).render();case 5:if(!(l=c.sent)){c.next=8;break}return c.abrupt("return",a.setFlag(C,"metadata",l));case 8:case"end":return c.stop()}}),_callee)}))),_editMetadata.apply(this,arguments)}var C="side-quest-society-free";Hooks.on("init",(function(){registerSettings(),initConfig()})),Hooks.on("ready",(function(){window.CallingCard=o}))})();
//# sourceMappingURL=index.js.map